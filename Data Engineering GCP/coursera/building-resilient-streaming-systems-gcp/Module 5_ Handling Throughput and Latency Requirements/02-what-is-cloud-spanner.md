## Choosing where to store data on GCP
So, if you're trying to choose, where should I store data on GCP? This is a set of questions that you could consider. So for example, first question that you might want to consider is: is the data that you're trying to store, is it structured data or is it unstructured data? So, if it is structured data, then the next question that you want to answer is: are transactions important to you? Or is your workload primarily read-only? Is your workload primarily around data analytics? If you are thinking about transactional workloads, then the next question is: do you want those transactional workloads the querying to be via a SQL or are you okay with the no SQL querying? So in other words, is your data relational? In which case you want to do SQL queries in your data. Or is your data not relational? In which case you want to do object stores for example. So now for example, if you have structured data, you need transactions and you want to be able to query it with SQL, then you have two options. The most common option would be to go ahead and use Cloud SQL. Cloud SQL is one database is going to be enough. But if one database is not enough, if you need multiple databases, you need horizontal scalability, then Cloud Spanner is a good solution. Both Cloud Spanner and Cloud SQL will give you millisecond latency. But if your workload is not around transactions, but if your workload is around data analytics, if your workload is around analyzing data, then this whole idea of transactions and locking, etc., is just overhead that you don't want to pay. And at that point, your question now becomes: Do you need updates? Do you need low-latency? If you don't need either of them, if low-latency of seconds is enough, then BigQuery is your most cost-effective solution. So, use BigQuery. Its a sequel database. It gives you reasonable latency but not very low-latency. But if you on the other hand, you want millisecond latency but you are primarily worried about analytics workloads, then Bigtable is a good solution. Now, lets look at the second part of this. If it's unstructured data that you're essentially dealing with, then unstructured data ideally goes into cloud storage. But if you need mobile SDKs, then Firebase storage would be a good solution. Similarly, if you have no SQL data, if you need mobile, put it on Firebase. If you don't need mobile, if it's primarily web applications, put it into Datastore. But what we are looking at in this course is then Cloud Spanner, Cloud SQL, Bigtable and BigQuery. And the way you think about these things is that BigQuery is your most common, very cost-effective latency of seconds. Cloud SQL, very common again, relational data, transactional data, backed by either a MySQL database or a PostgreSQL database. And then, you have two other solutions. And those are the two solutions that we look at in this chapter. If you have transactional SQL data and your workload is much larger, then you can fit on a single database, if you need horizontal scalability in other words go for Cloud Spanner. If you are doing data analytics but your needs are more than what BigQuery can support, go for Bigtable. So again, both Spanner and Bigtable are when BigQuery and Cloud SQL are not going to be enough for your needs. So, let's look at both big table and Spanner, starting with Spanner. So, when do you use Spanner? Use Spanner if you need globally consistent data. So, not just data in one region, not just data in one database, but you need data that needs to be globally consistent. You need more than one Cloud SQL instance. That's kind of the reason why you might want to use Cloud Spanner. And this graph shows you that. So, this is the mean latency associated with databases. And this red line here shows us MySQL cloud SQL installation. And as you can see pretty much, it hits a wall at about 9000 queries per second. This graph, by the way, is from a great blog by quizlet. So, this hits a throughput of about 9000 queries per second and that's it. You can't go any further. On the other hand, if you have a Cloud Spanner installation, you essentially get horizontal scalability. So here is cloud spanner with nine nodes and you basically get very good latency all the way up to about 6000 queries per second with nine nodes. But if you need more, no problem add more nodes. So, this blue line here is with 15 nodes and you get about 10,000 queries per second. You have a requirement that's more than that? Go to 30 nodes and it can support up to 20,000 queries per second, and so on and so on and so on. So, just go ahead and add nod and you can support higher and higher throughputs, but not just higher and higher throughputs but also global consistency. So you are not talking about eventual consistency anymore, you're talking about strong consistency transactions in a global case. So, if you have throughput needs that are more than what a single Cloud SQL instance can handle or if you need to have multiple databases because you want to be committing from multiple regions in a global application, then Cloud Spanner is a great choice. So again, this is all about transactions. So, Spanner and Cloud SQL, going back to this graph both Spanner and Cloud SQL are part of this transactional branch. So, they're both solutions to the transactional use case where Spanner is a lot more scalable than Cloud SQL is. So, should you use Spanner for everything? Absolutely not. Use Cloud SQL if your throughput needs are more reasonable, if a single database is going to be enough. Use Spanner only when your applications scale beyond that.
## How do you use Cloud Spanner?
So how would you use Cloud Spanner? Well, you use it like any other SQL database. It's a SQL database, it's fully managed so you create it from a Web Console, just like you create a MySQL Database. And then you interact with it via SQL, so it's pretty easy, right? So you you can follow this quick start guide, that essentially walks you through the graphical user interface, the web UI, to create a console. You're just essentially saying how many nodes you want and you're creating a database. You're creating tables, and you're inserting things into it using SQL. If you've used a SQL database, you know how to use Cloud Spanner. Nothing fancy there. And in terms of a client API, you have again client API libraries in a variety of languages. This link here shows you the Python API. So we're not going to talk too much about Cloud Spanner, it's easy to use. But in order to demonstrate it we'd be basically creating 30 nodes, and then we'd be wondering what to put in those 30 nodes. So let's skip that, and let's move on to Bigtable. 

So what's Bigtable? Bigtable, again, going back to our graph, Bigtable is about the case of streaming data when BigQuery isn't enough. So this is, again, a data analytics use case, and that's the use case that we are talking about in this course. We're talking about streaming data in this course. So we're talking about using Bigtable when the throughput needs are more than what BigQuery can handle. Or if your latency needs are, you will need smaller latencies, millisecond latencies, when BigQuery can only give you second latencies. So with BigQuery, BigQuery's easy, it's inexpensive, the latency's in the order of seconds, you get about 100,000 rows per second of streaming. Bigtable is low latency, it's very high-throughput. It's more expensive than BigQuery, because you're paying for the number of nodes of Bigtable that you're running. So if you're running a cluster that's ten nodes, for example, You can get 100,000 queries per second at six millisecond latency.

So pretty low latency, very high throughput. You pay for the number of clusters, those clusters are reserved for you.

So, in this chart Bigtable comes here. It is about having structured data for data analytics, not transactions, data analytics, that you need millisecond latency and very high throughput for.

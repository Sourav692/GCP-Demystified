0:01
So, let's take this example. This is my raw data.
0:06
I'm in an ice cream store. I'm trying to figure out if my ice cream is served by some employee and if the customer waited 1.4 seconds, or 1.4 minutes, what's the rating going to be?
0:21
I want to predict the rating. How satisfied is my customer going to be based on who served them, how long they waited, what it is that they bought, what the store location was, etc.? So fair enough, that's my data.
0:38
So that's my training data, I would take this training data and make them all numbers. Because neural networks deal with numbers. So I'll take my data, make them all numbers and those are my features. So in TensorFlow I'm going to take this thing, which is a JSON input, comes out of my web application ultimately goes into a data warehouse, I pull it out, I create numeric values. In TensorFlow each of these columns is a feature column.
1:11
So, how do we take some data like this and make them feature columns? Make them numeric.
1:20
First thing is there are some values like price or wait time. These are already numeric.
1:29
That's easy to encode. We just take them and use them as is. They're numeric, they have meaningful magnitude. So 2.5, 1.4 intense or flow in TF learn. This is what we call a real valued column. So I just say layers are real-valued-column 'price'. Layers that real-valued-column wait time. So these number that I used as is, they'll just be real-valued-columns.
2:04
How about this input? Transaction ID is 42,
2:13
No, that's way too specific. Throw it out, we can't use it as a feature.
2:20
How about employee ID? Employee ID is 72365. Is that numeric? Well, yeah its a number, but does it have meaningful magnitude? Is somebody with an employee ID of 72365 twice as good as somebody with an employee ID of 36182. No. Right? So I can't use the employee ID as it is. I have to do something with it. Let's say my ice cream shop has five employees, employee number 8345, employee number 72365 etc. What I can do is, I can say if this is employee number 72365, I'll represent this employee ID by this vector. The vector 01000 because I've defined the second column as corresponding to employee 72365. So essentially, I make it like a bit mask. You make that employees column one and all other columns zero. This is called One-hot encoding. There's one column that's hot and all the other columns are cold. If you have five employees in an ice cream store, you essentially have five columns. Actually, usually we do four because we wanted to be linearly independent just to detail. Let's not even worry about it we'll just say five employees, five columns. In TensorFlow, this is called a sparse column. You basically say that I want to create a sparse column with the keys. The column name is employee ID and the keys are 8345, 72365 etc. You just pass the strings for each of those keys. And then TensorFlow will take the string that you provide a direct training time, our prediction time and represent them. One-hot encode them. Make them all numeric. What we do is that we say that employee ID is a sparse column. This is if we know the keys beforehand.
5:04
What if I don't know the keys beforehand? What you would have to do is that you would take your input data, you would preprocess this data to find out all the keys that occur in your training dataset, create a vocabulary of keys. So that's your first step – that's the preprocessing. You'd have to do this before you do your training. And then, you would create a new dataset where these preprocessed values can then be used. So, before you ever get to training the model, you need to create a vocabulary, and this vocabulary needs to be available at prediction time because at prediction time, the user is gonna come back and say employee ID 72365, and the model needs to know that at training time, it decided that 72365 was the second column. So the vocabulary needs to be identical and the mapping of the vocabulary needs to be identical at prediction time. Otherwise, it's not gonna work. So what happens if you hire a new employee? Is the model still the same? Well at this point, you don't have a place to put this new employee. So what this means is that we're not able to predict for this new employee. So this is the kind of thing that you need to think about beforehand, and you might add something around what do I do with an employee that I don't know about – an employee that isn't found – and then you basically decide perhaps that you're gonna find the average of all your current employees and use them. Meanwhile, you collect data about the times that this employee is on duty and the customer satisfaction associated with this employee with different wait times and different things that they're serving. And then once you've collected that, you use that in your prediction. So if you Know the key, so if you know the keys beforehand, you essentially create sparse column with keys and you pass in the keys, you just hard code the keys. So these are all different ways of creating a sparse column. Sometimes your data might already be indexed. Why might your data already be indexed? Maybe for example you have Employee ID and they just happen to be numbers one to 1000. At that point they're already indexed. They're not arbitrarily big numbers all over the place, they're just one to n. If that's the case, you say I want to create a sparse column with the integerized feature which is Employee ID, and there are five employees. So where this is useful in our taxi example is that we'll use it for the hour of the day, because that's automatically integerized from 0 to 23. It's perfect as an integerized feature, because the hour of the day is not numeric, it's not completely numeric because the number like 23 is very close to the number 0 1. It's only 2 hours away. So let's take the third possibility. Suppose you don't have a vocabulary and it's not integerized. So here's a cool trick that you can do. You don't want to go out, build a vocabulary, and you don't really care. So what you do is that you say, I'm going to take my employee ID, hash it, compute the hash of the employee ID and just break that hash up into, I don't know, 500 buckets. Why would you do this? Like let's say you're in your company has 100 employees and you hash it to 500 buckets. So on average, each bucket will either have zero employee or one employee in it. It's almost like a one-hot encoding, but a 500-hot encoding, that kind of gets me the same thing, but without having to build a vocabulary.
9:40
So, the customer rating. What do we do with it? Well, if we are trying to predict the customer rating then it's a label and we're not even worried. But let's say that we're trying to use this as an input because we're trying to predict something else. So if you have something like a rating and you want to use it as an input feature you could do one of two things. You could treat it like a continuous number, 1-5. It's numeric. It sort of has a meaningful magnitude for us more than three or you can say that four stars is very different from five stars is very different from two stars in which case I am going to one-hot encode it. So, in some cases you have choices, to the customer rating; you can one-hot encode it or you can treat it as a number. Up to you, choose how to deal with the rating.
10:43
But one thing to watch out for is what you do if the customer didn't actually provide a rating? That you might be doing a survey and the customer didn't answer that survey? So, what do you do with missing data?
11:00
One option is to use two columns.
11:07
One for the rating, And one for whether or not you got a rating. So in this case, 

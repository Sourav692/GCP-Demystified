0:00
So in this lab, what we did is that we learned how to use TensorFlow, TFLearn, right? So pretty much here the same as before, the differences are that I'm getting BigQuery, and I'm also getting pandas, right? Because I'm going to basically load my data from BigQuery into pandas. So, what I'm going to be doing is I'm going to go to pandas, PDS Pandas. Sensing read csv taxi trained at csv. Remember, this is the file that we created when we did train valid and tests. So I'm reading the taxi train. I'm saying there is no header. This is very common in big data problems. You don't write headers right because you want to sort your data and headers just get in the way right. So basically, header is none and the names of the columns, because there is no header I want to provide names. So I am saying those are the names I have to remember what they are because I wrote them out. So that is a fair amount the pick up longitude, pick up latitude. Drop of longitude, drop of latitude, number of passengers, and the key. The key is just the unique thing for that row. And we don't actually need the key here. But, later on, we'll need the key because we will ask Cloud ML engine to do predictions and we'll give it a bunch of frills and it's going to come back, it's going to parallelize all of them and bring them back to us. And we want to know which prediction is for which. And the key is the way we can identify that this is the prediction for this particular role, right? So, it's a good idea when you start out with machine learning in your data that you have a key.
1:40
So we're going to have a key there. So that's our key, my features though, fair amount is not a feature and the key is not a feature. So I go from one to length of CSV columns minus one. Fair enough? Yeah and my target is the first CSV column Fair amount. So this is pretty straight forward. This is just reading data. And then I have to create an input function. The input function is to return a feature and it is to return a label. So I make my input function. Here's my input function that I'm going to return, okay? So this level of indirection here, the reason being, the input function can take a parameter.
2:21
For to answer flow says give me an input function that I can just call without a parameter. But I need to know the data frame to pull data from. And so I make a function that has a data frame. And I use that data frame here and then I return the input function. So this input function gets called and this guy uses the data frame. So, that's the reason for this slightly convoluted thing. Does that make sense to everyone? Right? I need a function that doesn't take a parameter. So if you're used to Java, this is like writing an anonymous inner class. You need the function that does not need to take the parameter. So you construct an object and you pass those things in the constructor. This is very similar to that. And the reason I keep using java as my, this is how it works in java is because that is a vast a primary language. Python is not a primary language. So every time I look at Python code and write Python code, I said, this is how I do it in Java. Okay, this is equivalent to what I would do in Java, right? So this is basically what we're doing here. Does this make sense to everyone? I need an input function that takes no parameters. And I don't have an input function that takes no parameters because I do need the Pandas Dataframe to pull data from. So I basically passed in the panda's data frame and then from that panda's data frame, I converted to TF constant. So basically, panda' s tf given a panda's column, I basically converted it to be a float 32 to make it an empire array called TF constant and then basically pad it out changing the shape, right? The shape is of N, I need to make it N, 1. So I do that, I get my pandas frame, right? So most of TensorFlow code is basically figuring out what shape you need thinks it, okay? So you make a constant, and you get your target, you get your values, and that's your label. So features and labels return the features and labels. So this is all about managing the data that I get from Pandas into the n,1 array that tensor flow needs.
4:25
Fair enough? I just need an n,1 array and I'm just doing that. That's basically what my input function does. My feature columns, though It's for every feature. Every one of them is a real valued column. So, just make a list of re-evalued columns for every feature, that's my input columns.
4:45
And now, I have my input, I have my features. I can then do linear regression, which is as simple as create a linear regressor with these featured columns, okay? And that's where I want my output to go, and fit the model with this input function using the DF train, right? The data frame train, the Panda data frame train and do it for 10 steps
5:17
Everyone okay with that? Yes? >> Is that going over the whole epack? >> In this case, because I'm passing that entire array at once, that size and epack size are the same.
5:31
Later on, when I read CSV file, we'll read them in chunks and then they'll become different. So at this point yes, it's 10 batches, a step is a batch. So 10 batches but as it turns out, we're providing all of the data at once. So the batch is the same as the good question.
5:54
Everyone okay with that? Next, at this point we have our model. We want to evaluate the model. So what I do is I basically go to the model and I say please evaluate using this input function. Which input function? Of the all right passing the validation set and say please evaluate it, number of steps is only one. We going to passing all the data just evaluate over the entire data. And we basically get back a metric, the metric we are getting back is mean²error. I want to print root mean²error, so I take the square root.
6:31
And then for deep neural nets it's exactly the same thing. The only difference is I use a DNN repressor.
6:40
The point, once we ran this though what kind of error did you guys get? Pretty high. How high?
6:49
200-ish, that was squared error though, right? The squared error is 200, so the root means square error would be square root of somewhat 14. What was that benchmark? >> 8. >> Not quite there yet, right. Hey we wrote our tensor flow model, we trained it but not so good. >> Not so good. >> For Twitters. >> [LAUGH] >> Is your machine learning smart >> Okay? So that's basically what you've done, right? We basically created our model, we've trained it but what we did was something what people think machine learning is. You will get your data and you throw it into your model and you basically get magic nd yes, the s side doesn't work that way.
7:36
Okay? Here you have a machine learning model, you've done machine learning. But what you got, if you didn't do any better, you'd say, well I did it, I got 14, RSA 14. But you and I know that we have a benchmark that says that with this data even a simple rule can get us to eight. 

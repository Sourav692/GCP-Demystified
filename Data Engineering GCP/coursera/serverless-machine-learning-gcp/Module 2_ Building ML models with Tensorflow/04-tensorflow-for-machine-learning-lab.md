0:00
Now that we've looked at Core TensorFlow, let's look at how to use TensorFlow for machine learning. So we will skip all the way to the top of the hierarchy and we look at the Estimator API. So the way you work with the Estimator API is that first of all, you setup a machine learning model. Is this a regression problem or is this a classification problem? What's the label? What are the features? So, in my example, I'm going to build a machine learning model that tries to predict the price of a house given the area of the house, the square footage of the house. So, is this a regression problem or is it a classification problem? It's a regression problem because we're predicting a price which is a continuous number. So what's the label? The label would be the price. You probably have data from many houses. And for each of those houses, you have a square footage and the price that the house sold for. And that price is the label. And the features, in our case, is only one feature, which is a square footage of the house. Once you set up this machine learning model in this form, whether it's regression or classification, what's the label, what are the features, then you can take this model and you do three things with it. You train the model, you adjust the weights of the model in such a way that the output of the model for a given input is very close to the label for that input, and then you evaluate the model to figure out how well this model actually works. And the third thing that you might want to do with a model is that you want to predict with the model. So you have a house for which you don't know the price, and you ask the model, "Here's a square footage, tell me what the price would be." And the model then predicts what the price is. So let's go ahead and look at how these steps work. So we are importing TensorFlow as TF. Let's ignore the feature columns for now. The first thing is that we are answering whether it's a regression model or a classification model. And the way we answer that question is that when we create the estimator, we create a linear regressor or a linear classifier. Of course there are other things other than linear, but for now, we will go with linear. So, regressor for regression problems, classifier for classification problems. So, estimator is a linear regressor with a specific set of columns. So what are those columns? The columns here is a list. So that square bracket in Python makes the list. So a feature columns is a list of one column because we have only one input. That column is called square footage. So that feature column is the input into this machine learning model. So we've created a machine learning model, a linear regressor, with one input. And that input is a real_valued input and it's the square footage. So now that we've created the estimator, the thing that we might want to do with this estimator is that we might want to train it. And the way you train the estimator is that you call the fit function on the estimator, passing in a way for it to go get all the training data. So the input function is a way for the estimator to be fed in all of the input data. And the way this works is that I'm defining input function train, and I'm basically making feature data, which is going to be a dictionary. The curly brace here is a dictionary. So I'm making the dictionary and the input square footage, which is that column there, the square footage. I'm making that square footage a tf.constant in a tensor with two elements in it, 1,000 and 2,000. And then, the corresponding labels are also a tensor of $100,000 and $200,000. So I have feature data, which is a dictionary of features. So you can have many features, that a dictionary of features, and your label data, the label, the thing that you're trying to predict, and the true value of the thing that you're trying to predict in the training data. So you take that label data and then you do estimator that fit, passing in the input function, and saying that you want this to be done 100 times. So the steps is 100 steps. Remember that a step is actually one step of gradient descent. So it's typically done on a batch. But in this case, our entire dataset is in memory and our entire dataset has two points in it, so our entire dataset in memory. So, a step here is the same as an epoch because our entire dataset consists of one batch. So we go ahead and we call the fit function on the estimator passing in the input function, the way that it is going to get all the training data, and we say, go ahead and carry out gradient descent 100 times. So, go ahead and do this optimization 100 times and then keep those weights that you have. Once we have the weights, we can go ahead, and we can predict what the weights are. And what we can do to predict, passing in another input function, this time, because we're predicting, we don't actually have the label. We only have to provide the features. So the input function for prediction basically is the same thing, square footage, passing in. Here, I want to predict the price of one house, and that house has a area of 1,500 square feet. So we take that feature, we pass it in, and we go ahead and do our predict. And this is basically going to give us back a tensor that basically has one element in it. I'm just making that a Python list, and we can do whatever we want to do with that list. So, bottom line then, steps to define an Estimator API model. First step, setup your feature columns. What are your inputs to this model going to be? Step number two, create a model, passing in the feature columns. And when you create the model, you'll specify whether it's a regression problem or a classification problem. There are several types of regressors and several types of classifiers. We'll look at them later. And then, you will write an input function to get your training data. And that input function is going to return all of the features and their labels, where the features is a dictionary. And then, you will train the model using estimator.fit. And then, once you have trained the model, you can use that trained model to predict the price of new houses. So, besides the linear regressor, we have other types of regressors. For example, if you want to do a Deep Neural Network, instead of saying linear regressor, you would now say, Deep Neural Network regressor. And then, because it's a Deep Neural Network regressor, its constructor takes in the architecture of the network. So, in this case, we are creating a three-layer network, three hidden layers. So, depending on the way you count, you have a total of five layers, one input, three hidden, and one output. So the three hidden layers are 128 nodes in the first layer, 64 nodes in the second layer, 32 nodes in the third layer. How do you know how many nodes you have to use? Well, this is something that we will experiment with later. So you can create a Deep Neural Network regressor. So what if you want to do classification? Well, instead of saying linear regressor, now you would say linear classifier, making sure that your label now is a number zero or one or is basically the class number if you have multiple classes. So you can have a linear classifier or you can have a Deep Neural Network classifier. We looked at one type of feature column, a real_valued feature column. There are many other types of feature columns. We will look at them later when we look at feature engineering. So let's go ahead and do this lab where your training from data in a Pandas frame, which is all in memory in other words. And then you're implementing an a lab regression model, a linear regression model in TensorFlow, and then repeating it with a Deep Neural Network model. 

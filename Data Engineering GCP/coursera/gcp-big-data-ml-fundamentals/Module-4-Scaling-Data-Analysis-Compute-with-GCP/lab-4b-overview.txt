0:01
So, let's go ahead and do this in data lab. So in this lab, what you're going to do is you're going to complete the thing that you started. You have you data set ready. Let's use that data set to carry out machine learning training.
0:15
So, go back to data lab, And here, we now have our data, and we are ready to start Machine Learning with Dataflow, that's important, this data, shuffle it, and get the predictors. The reason I'm shuffling is that I'm going to separate this out into a training data set and a validation data set, so it does work. I'm going to train on maybe like 75% of the data and validate the remaining 25%. So this is the different days of the week. That's not predictors and let's print out the things that are being shuffled. That's our targets for each of those days and then. Now, figure out what we would get if we predicted that everything is just the average, and on our training data said the average turns out to be 47,000, and the int hat case would be about twelve thousand five hundred taxi cab rides. So let's go ahead and do a linear regression model. And a linear regressor, so instead of DNN regressor I'm doing linear regressor here. And essentially what I'm doing is I'm basically creating the number of predictors, getting the number of inputs, creating a linear regressor and then fitting it and predicting it.
1:37
So we do this.
1:43
Don't worry too much about the error messages. Tensorflow is a work in progress so you might see a few error messages over time. Those should go away as also we change the code to become something that's closer to what's in production.
2:00
So we train it and we get an RMSE of 11,000, so about 1,000 less.
2:07
So here, instead of using linear regression, I'm using DNNRegressor, so I can train the DNNRegressor on the model. So here again I'm basically just creating a linear regressor or DNN regressor, calling the fit method, then basically checking out how well it does at predicting this held out of the training data sets. This is a very small data set, so you're not going to get many major improvements. Sometimes you won't get any improvement. And in this case for example, the linear model out perform the deep neural net, because we didn't have enough data to support the number of hidden nodes that we had. As you recall, you need to basically pick a model that's good enough to capture it, and as simple enough as possible. So once we have our model, regardless of what model it is, we can then go ahead and create a dictionary and we can predict with it. So this is basically what our predictions are going to be on those three days and you can kind of see why are model wasn't very good. It's predicting Potentially the same values for all three days.
3:17
Your results on this lab will be different because of the use of random seeds everywhere but the denser flow. But this again the purpose of this lab is to show you how we can use denser flow to drain a model. In reality your data sets would be larger, hopefully. In this case my data set was 365 days a year for two years so my data set was 500, 600 rows long or something like that, 720 rows. If I didn't think I had all the years even, so it's actually less than that. That's a really small data set for demonstration purposes. In reality, you should do machine learning on a large data set. At least thousands of rules and at that point then you will start to see the benefits of training. You will start to see the benefits of neural networks if you use larger datasets. However, this lab showed you how you would get this done. If you're interested in knowing more about machine learning, come to our data engineer course, where we take a more realistic example. We'll be training on data sets that are a million rows log. 
